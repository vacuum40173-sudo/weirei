<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>éŸ‹ç‘ç•«å»Š v6.9.1</title>
    <style>
        :root { --primary: #3498db; --secondary: #2c3e50; --accent: #e67e22; --success: #27ae60; --bg: #f4f7f6; }
        body { font-family: "Microsoft JhengHei", sans-serif; background-color: var(--bg); padding: 10px; display: flex; flex-direction: column; align-items: center; margin: 0; }
        .card { background: white; padding: 18px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); width: 100%; max-width: 500px; margin-bottom: 15px; box-sizing: border-box; }
        h2, h3 { text-align: center; color: var(--secondary); margin: 0 0 15px 0; border-bottom: 2px solid var(--primary); padding-bottom: 8px; font-size: 1.25rem; }
        label { display: block; margin-bottom: 5px; font-weight: bold; color: #555; font-size: 0.9rem; }
        input, select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; font-size: 1rem; background: #fff; }
        .row { display: flex; gap: 8px; align-items: flex-end; margin-bottom: 10px; }
        .option-group { background:#fff9f0; padding:12px; border-radius:10px; border: 1px solid #ffe0b2; margin: 10px 0; }
        .live-price-box { background: #fff; padding: 12px; border-radius: 8px; text-align: center; border: 2px dashed var(--accent); margin: 15px 0; }
        .live-price-val { font-size: 2.2rem; font-weight: bold; color: var(--accent); }
        .btn { border: none; width: 100%; padding: 14px; border-radius: 8px; font-size: 1.1rem; font-weight: bold; cursor: pointer; color: white; margin-top: 8px; }
        .btn-add { background-color: var(--success); }
        .cart-table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 0.95rem; }
        .cart-table td { padding: 10px 5px; border-bottom: 1px solid #eee; }
        .hidden { display: none !important; }
        @media print { .no-print { display: none !important; } .card { box-shadow: none; border: none; width: 100%; } }
    </style>
</head>
<body>

<div class="card no-print">
    <h2>éŸ‹ç‘ç•«å»Š v6.9.1</h2>
    <div style="background: #fcfcfc; border: 1px solid #eee; padding: 12px; border-radius: 8px;">
        <label>ğŸ‘¤ å®¢æˆ¶è³‡æ–™</label>
        <div class="row"><input type="text" id="cust_name" placeholder="å§“å"><input type="tel" id="cust_phone" placeholder="é›»è©±"></div>
    </div>
</div>

<div class="card no-print" id="inputSection">
    <h3>ğŸ’° å ±åƒ¹è¨ˆç®—</h3>
    <div class="section">
        <label>å ±åƒ¹æ¨¡å¼</label>
        <select id="mode" onchange="toggleMode()">
            <option value="normal" selected>åœ‹ç•«è£æ¡† (å‘¨é•·è¨ˆåƒ¹)</option>
            <option value="oil">æ²¹ç•«è£æ¡† (å †ç–Šè¨ˆåƒ¹)</option>
            <option value="board">åœ‹ç•«è£±æ¿ (é¢ç©è¨ˆåƒ¹)</option>
            <option value="scroll">ç«‹è»¸æ›è»¸</option>
        </select>
    </div>

    <div class="row" style="margin-top:10px;">
        <div style="flex:1;"><label>ç•«å¿ƒé•· (ä¸‰ä½æ•¸)</label><input type="number" id="L_in" placeholder="000" oninput="runCalc()" inputmode="numeric"></div>
        <div style="flex:1;"><label>ç•«å¿ƒå¯¬ (ä¸‰ä½æ•¸)</label><input type="number" id="W_in" placeholder="000" oninput="runCalc()" inputmode="numeric"></div>
    </div>
    <div class="row">
        <div style="flex:1;"><label>é ç•™é•·é‚Š (ä¸‰ä½æ•¸)</label><input type="number" id="padL" value="100" oninput="runCalc()" inputmode="numeric"></div>
        <div style="flex:1;"><label>é ç•™çŸ­é‚Š (ä¸‰ä½æ•¸)</label><input type="number" id="padW" value="050" oninput="runCalc()" inputmode="numeric"></div>
    </div>

    <div id="normal-options" class="option-group">
        <label>é¸æ“‡æ¡†ç¨®èˆ‡åŸºæ•¸</label>
        <select id="baseRate" onchange="runCalc()">
            <option value="250">åœ‹ç•«æ¡† (250)</option>
            <option value="280">2å¯¸ç‰¹é¸æ‰‹å·¥æ¡† (280)</option>
            <option value="300">3å¯¸ç‰¹é¸æ‰‹å·¥æ¡† (300)</option>
            <option value="inner_outer">åœ‹ç•«å…§å¤–æ¡† (250 - å«å£“å…‹åŠ›)</option>
        </select>
        <div id="acyRow" style="margin-top:10px;">
            <label style="font-weight:normal;"><input type="checkbox" id="addAcy" onchange="runCalc()" style="width:auto;"> åŠ å£“å…‹åŠ› (120/æ‰)</label>
        </div>
    </div>

    <div id="oil-options" class="option-group hidden">
        <label>æ²¹ç•«æ–½ä½œæ–¹å¼</label>
        <select id="oilType" onchange="runCalc()">
            <option value="direct">ç›´æ¥æ¡† (å–®ç´”æ¡†æ¢)</option>
            <option value="solid">ç«‹é«”æ¡† (åº•æ¿+æ¡†æ¢)</option>
            <option value="inout">å…§å¤–æ¡† (åº•æ¿+æ¡†æ¢+å…§æ¡†)</option>
        </select>
        <label style="margin-top:10px;">å¤–æ¡†æ¢åŸºæ•¸</label>
        <select id="oilFrameBase" onchange="runCalc()">
            <option value="20">6åˆ†æ¡† (20)</option>
            <option value="25">å¯¸åŠæ¡† (25)</option>
            <option value="35">å…©å¯¸åŠæ¡† (35)</option>
            <option value="45">ä¸‰å¯¸æ¡† (45)</option>
        </select>
    </div>

    <div class="section"><label>ğŸ“ å–®é …å‚™è¨»</label><input type="text" id="item_note" placeholder="å¦‚ï¼šåŠ é‡‘é‚Šã€ç‰¹æ®Šé¡è‰²..."></div>

    <div class="live-price-box">
        <div class="live-price-val">NT$ <span id="priceTxt">0</span></div>
        <div id="sizeDetail" style="font-size:12px; color:#7f8c8d; margin-top:5px;"></div>
    </div>
    <button class="btn btn-add" onclick="addItem()">ï¼‹ åŠ å…¥å ±åƒ¹æ¸…å–®</button>
</div>

<div class="card" id="cartSection">
    <h3>ğŸ“ å ±åƒ¹æ¸…å–®</h3>
    <table class="cart-table" id="cartTable"></table>
    <div style="text-align:right; font-size:1.3rem; font-weight:bold; color:#c0392b; margin-top:15px; border-top:2px solid #eee; padding-top:10px;">
        ç¸½è¨ˆï¼šNT$ <span id="totalTxt">0</span>
    </div>
    <div class="no-print">
        <button class="btn" style="background:#3498db;" onclick="window.print()">åˆ—å°å–®æ“š / æˆªåœ–å­˜æª”</button>
        <button class="btn" style="background:#95a5a6; margin-top:10px;" onclick="location.reload()">ä¸‹ä¸€å¼µæ–°å–®</button>
    </div>
</div>

<script>
    const TAI_TO_CM = 30.3;
    const TAI_TO_INCH = 11.93;
    let cart = [];
    let currentPrice = 0;

    function runCalc() {
        const mode = document.getElementById('mode').value;
        
        // å…¨éƒ¨çµ±ä¸€ç‚ºä¸‰ä½æ•¸è¼¸å…¥é‚è¼¯ï¼Œé™¤ä»¥ 100 å¾—åˆ°ã€Œå°ºã€
        const L = (parseFloat(document.getElementById('L_in').value) || 0) / 100;
        const W = (parseFloat(document.getElementById('W_in').value) || 0) / 100;
        const pL = (parseFloat(document.getElementById('padL').value) || 0) / 100;
        const pW = (parseFloat(document.getElementById('padW').value) || 0) / 100;
        
        if (L <= 0 || W <= 0) { 
            document.getElementById('priceTxt').innerText="0"; 
            document.getElementById('sizeDetail').innerText = "";
            return; 
        }

        const tL = L + pL; const tW = W + pW;
        const Lcm = tL * TAI_TO_CM; const Wcm = tW * TAI_TO_CM;
        const Linch = tL * TAI_TO_INCH; const Winch = tW * TAI_TO_INCH;
        const cai = Math.ceil((Linch * Winch) / 144);
        
        document.getElementById('sizeDetail').innerText = `æ¡†å…§å°ºå¯¸ï¼š${Lcm.toFixed(1)} x ${Wcm.toFixed(1)} cm (${tL.toFixed(2)} x ${tW.toFixed(2)} å°º)`;

        if (mode === 'normal') {
            const base = document.getElementById('baseRate').value;
            if (base === 'inner_outer') {
                currentPrice = Math.round((tL + tW) * 2 * 250);
                document.getElementById('acyRow').classList.add('hidden');
            } else {
                currentPrice = Math.round((tL + tW) * parseInt(base));
                document.getElementById('acyRow').classList.remove('hidden');
                if(document.getElementById('addAcy').checked) {
                    currentPrice += Math.round(cai * 120);
                }
            }
        } 
        else if (mode === 'oil') {
            const type = document.getElementById('oilType').value;
            const base = parseInt(document.getElementById('oilFrameBase').value);
            let baseP = (type === 'direct') ? 0 : Math.round(cai * 50);
            let frameP = Math.round((Linch + Winch) * base);
            let inP = (type === 'inout') ? Math.round((Linch + Winch) * 12) : 0;
            currentPrice = baseP + frameP + inP;
        } 
        else { 
            currentPrice = 350;
        }

        if(currentPrice < 350) currentPrice = 350;
        document.getElementById('priceTxt').innerText = currentPrice.toLocaleString();
    }

    function toggleMode() {
        const m = document.getElementById('mode').value;
        document.getElementById('normal-options').classList.toggle('hidden', m !== 'normal');
        document.getElementById('oil-options').classList.toggle('hidden', m !== 'oil');
        runCalc();
    }

    function addItem() {
        if(currentPrice <= 0) return;
        const mName = document.getElementById('mode').options[document.getElementById('mode').selectedIndex].text;
        const note = document.getElementById('item_note').value;
        cart.push({ 
            title: mName, 
            price: currentPrice, 
            spec: document.getElementById('sizeDetail').innerText, 
            note: note ? `(${note})` : "" 
        });
        renderCart();
        document.getElementById('item_note').value = "";
    }

    function renderCart() {
        const table = document.getElementById('cartTable'); 
        table.innerHTML = ""; 
        let total = 0;
        cart.forEach((it, idx) => {
            total += it.price;
            table.innerHTML += `<tr>
                <td style="padding:8px; border-bottom:1px solid #eee;">
                    <b>${it.title}</b><br>
                    <small>${it.spec} ${it.note}</small>
                </td>
                <td align="right">${it.price.toLocaleString()}</td>
                <td align="right">
                    <button onclick="cart.splice(${idx},1);renderCart()" style="color:red;border:none;background:none;font-size:1.2rem;cursor:pointer;">Ã—</button>
                </td>
            </tr>`;
        });
        document.getElementById('totalTxt').innerText = total.toLocaleString();
    }

    window.onload = function() {
        toggleMode();
    };
</script>
</body>
</html>
